C51 COMPILER V9.60.0.0   DELAY                                                             12/19/2022 17:43:51 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DELAY
OBJECT MODULE PLACED IN .\Objects\delay.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE src\delay.c LARGE OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Li
                    -stings\delay.lst) TABS(2) OBJECT(.\Objects\delay.obj)

line level    source

   1          /***************************************************************************//**
   2          *   @file       delay.c
   3          *   @brief      Polling Delay subroutine
   4          *   @author     V&V Team, ABOV Semiconductor Co., Ltd.
   5          *   @version    V1.00
   6          *   @date       28. NOV. 2019
   7          *
   8          * Copyright(C) 2019, ABOV Semiconductor
   9          * All rights reserved.
  10          *
  11          ********************************************************************************
  12          * ABOV Disclaimer
  13          *
  14          *IMPORTANT NOTICE - PLEASE READ CAREFULLY
  15          *ABOV Semiconductor ("ABOV") reserves the right to make changes, corrections, enhancements, 
  16          *modifications, and improvements to ABOV products and/or to this document at any time without notice. 
  17          *ABOV does not give warranties as to the accuracy or completeness of the information included herein.
  18          *Purchasers should obtain the latest relevant information of ABOV products before placing orders. 
  19          *Purchasers are entirely responsible for the choice, selection, and use of ABOV products and 
  20          *ABOV assumes no liability for application assistance or the design of purchasers' products. No license, 
  21          *express or implied, to any intellectual property rights is granted by ABOV herein. 
  22          *ABOV disclaims all express and implied warranties and shall not be responsible or
  23          *liable for any injuries or damages related to use of ABOV products in such unauthorized applications. 
  24          *ABOV and the ABOV logo are trademarks of ABOV.
  25          *All other product or service names are the property of their respective owners. 
  26          *Information in this document supersedes and replaces the information previously
  27          *supplied in any former versions of this document.
  28          *2020 ABOV Semiconductor  All rights reserved
  29          *
  30          */
  31          
  32          /* Includes ------------------------------------------------------------------*/
  33          #include    "typedef.h"
  34          #include    "Intrins.h"
  35          #include    "delay.h"       //
  36          /* Private Pre-processor Definition & Macro ----------------------------------*/
  37          /* Private Typedef -----------------------------------------------------------*/
  38          /* Private Variable ----------------------------------------------------------*/
  39          /* Private Function Prototype ------------------------------------------------*/
  40          /* Public Variable -----------------------------------------------------------*/
  41          /* Public Function -----------------------------------------------------------*/
  42          /***************************************************************************//**
  43          * @brief    System NOP 1us Delay rountine. (MCLK = 16MHZ)
  44          * @note     1 machine cycle comprises 1 system clock cycles. (@ABOV 94 Core Serise)
  45          *           16 system clock delay
  46          * @param    None
  47          * @return   None
  48          *******************************************************************************/
  49          volatile void NOP_1us_Delay(void)
  50          {
  51   1          // ACALL, LCALL : 4, 2 cycle => 4, 2 system clock cycle
  52   1          NOP; NOP; NOP; 
  53   1        NOP; NOP; NOP;    // NOP : 1 cycle => 1 sys. clock => 6 sys. clk
  54   1          // RET : 4 cycle => 4 system clock cycle
C51 COMPILER V9.60.0.0   DELAY                                                             12/19/2022 17:43:51 PAGE 2   

  55   1          // 16 sys. clk @16MHZ = 62.5ns x 16 = 1us
  56   1      }
  57          /***************************************************************************//**
  58          * @brief    System NOP 10us Delay rountine. (MCLK = 16MHZ)
  59          * @note     1 machine cycle comprises 1 system clock cycles. (@ABOV 94 Core Serise)
  60          *           160 system clock delay
  61          *           1 machine cycle can be added depending on code optimization.
  62          *
  63          *           ex1)    MOV R7,#(Low byte of delay)
  64          *                   MOV R6,#(high byte of delay)
  65          *                   LCALL   NOP_10us_Delay
  66          *
  67          *           ex2)    MOV A,#(Low byte of delay) // Lower byte and higher byte are the same.
  68          *                   MOV R7,A
  69          *                   MOV R6,A
  70          *                   LCALL   NOP_10us_Delay
  71          *
  72          * @param    delay : unsigned int 1~65,355 (delay) * 10us (@System clock = 16Mhz)
  73          * @return   None
  74          *******************************************************************************/
  75          volatile void NOP_10us_Delay(unsigned int delay)
  76          {
  77   1        NOP_1us_Delay();
  78   1        NOP_1us_Delay();
  79   1        NOP_1us_Delay();
  80   1        NOP_1us_Delay();
  81   1        NOP_1us_Delay();
  82   1        NOP_1us_Delay();
  83   1        NOP_1us_Delay();
  84   1        NOP_1us_Delay();
  85   1        NOP_1us_Delay();
  86   1        NOP_1us_Delay();
  87   1      //    // mov r7 <- low byte of delay      // 1cycle
  88   1      //    // mov r6 <- high byte of delay     // 1cycle
  89   1      //    // lcall NOP_10us_Delay             // 2cycle
  90   1      //    
  91   1      //    // dummy assignment to avoid warning
  92   1      //    // 'unreferenced local variable'
  93   1      //    // Reference Link : http://www.keil.com/support/docs/2622.htm
  94   1      //    // delay -> [r6:r7]
  95   1      //    
  96   1      //    delay = delay;  // dummy
  97   1      //                    
  98   1      //    #pragma asm
  99   1      //        lcall   NOP_1us_Delay
 100   1      //        lcall   NOP_1us_Delay
 101   1      //        lcall   NOP_1us_Delay
 102   1      //        lcall   NOP_1us_Delay
 103   1      //        lcall   NOP_1us_Delay
 104   1      //        lcall   NOP_1us_Delay
 105   1      //        lcall   NOP_1us_Delay
 106   1      //        lcall   NOP_1us_Delay
 107   1      //    
 108   1      //    nop
 109   1      //        nop
 110   1      //    nop
 111   1      //        nop
 112   1      //        nop
 113   1      //        nop
 114   1      //        nop
 115   1      //        nop
 116   1      //        nop     //add 9cycle
C51 COMPILER V9.60.0.0   DELAY                                                             12/19/2022 17:43:51 PAGE 3   

 117   1      //        clr     c                           // 1cycle
 118   1      //        mov     a,r7                        // 1cycle
 119   1      //        subb    a,#2                        // 1cycle
 120   1      //        mov     r7,a                        // 1cycle
 121   1      //        mov     a,r6                        // 1cycle
 122   1      //        subb    a,#0                        // 1cycle
 123   1      //        mov     r6,a                        // 1cycle
 124   1      //        jc     _nop_10us_delay_loop_end     // 2cycle
 125   1      //        
 126   1      //    _nop_10us_delay_loop:
 127   1      //        lcall   NOP_1us_Delay
 128   1      //        lcall   NOP_1us_Delay
 129   1      //        lcall   NOP_1us_Delay
 130   1      //        lcall   NOP_1us_Delay
 131   1      //        lcall   NOP_1us_Delay
 132   1      //        lcall   NOP_1us_Delay
 133   1      //        lcall   NOP_1us_Delay
 134   1      //        lcall   NOP_1us_Delay
 135   1      //    
 136   1      //    lcall   NOP_1us_Delay
 137   1      //        nop
 138   1      //        nop
 139   1      //        nop
 140   1      //        nop
 141   1      //        nop
 142   1      //        nop
 143   1      //        nop
 144   1      //    nop
 145   1      //        nop
 146   1      //        nop
 147   1      //        nop
 148   1      //        nop
 149   1      //        
 150   1      //        clr     c                           // 1cycle
 151   1      //        mov     a,r7                        // 1cycle
 152   1      //        subb    a,#1                        // 1cycle
 153   1      //        mov     r7,a                        // 1cycle
 154   1      //        mov     a,r6                        // 1cycle
 155   1      //        subb    a,#0                        // 1cycle
 156   1      //        mov     r6,a                        // 1cycle
 157   1      //        jnc     _nop_10us_delay_loop        // 2cycle
 158   1      
 159   1      //    _nop_10us_delay_loop_end:
 160   1      //        nop                                 // 1cycle
 161   1      //    nop
 162   1      //    nop
 163   1      //    nop
 164   1      //        
 165   1      //    #pragma endasm
 166   1      //                                            // ret 2cycle
 167   1      }
*** WARNING C280 IN LINE 75 OF src\delay.c: 'delay': unreferenced local variable
 168          
 169          /* --------------------------------- End Of File ------------------------------ */


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     45    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----       2
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
C51 COMPILER V9.60.0.0   DELAY                                                             12/19/2022 17:43:51 PAGE 4   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
